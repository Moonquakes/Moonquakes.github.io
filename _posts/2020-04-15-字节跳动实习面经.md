---
layout:     post
title:      字节跳动实习面经
subtitle:   字节跳动上海服务端 2020 暑期实习 面经分享
date:       2020-04-15
author:     Xavier
header-img: img/ByteDance.jpg
catalog: true
tags:
    - 面经
    - 字节跳动
    - 实习

---

### 前言

总的来说，字节的面试官给我的感觉都是非常友善的，这次投的是上海服务端开发实习的提前批，一共进行了三次技术面试。



### 一面 3-16

1. 自我介绍

2. 算法题

   > 在微服务部署具体项目的时候，往往会遇到服务之间的相互依赖问题，那么就需要分批次部署，每一次部署都只能部署那些没有被依赖的服务，给定所有的服务以及他们依赖的服务，返回每个批次能部署的服务。（不需要考虑循环依赖的问题）
   >
   > 示例：
   >
   > 输入：1 -> [2,3]；2- > [3,4]；3 -> [5,6]；4-> [6]；5 -> []；6 -> []
   >
   > 输出：第一批 5，6；第二批 3，4；第三批 2 ；第四批 1

   和拓扑排序差不多，可以先把依赖关系转化为被依赖关系，也就是对于每一个服务它被哪些服务依赖，用inDegree数组记录每一个服务被多少个服务所依赖，然后每一批部署的时候找那些不被任何服务依赖的服务进行部署，并把他依赖的服务对应的inDegree值减一。

3. 概率题

   > 两个人抛硬币，谁先抛到正面谁赢，问两个人赢的概率各是多少

   假设甲先抛，那么第一个来回甲胜的概率是1/2（正），第二个来回甲胜的概率是1/2 * 1/2 * 1/2（反反正），所以就是求下面这个式子的结果：
   $$
   \sum_1^n{1\over 2^{2n-1}}
   $$
   无穷等比数列求和，当n趋向于无穷时，结果就是2/3。所以甲赢的概率是2/3，乙赢的概率是1/3。

4. 数据库联合索引

   对一张表里的ABC三个属性建立联合索引，那么：

   - where B = xxx and C = xxx会使用索引吗？不会，最左前缀原则。

   - where A = xxx and B = xxx会使用索引吗？会
   - where B = xxx and A = xxx会使用索引吗？会，mysql引擎会自动优化成上一种。

5. TCP的三次握手和四次挥手的过程

   网上很多就不说了



### 二面 3-20

1. 自我介绍

2. 项目介绍

3. TCP的四次挥手，解释需要TIME_WAIT状态的原因和CLOSE_WAIT过多的解决方法

   - TIME_WAIT：客户端接收到服务器端的 FIN 报文后进入TIME_WAIT状态，此时并不是直接进入 CLOSED 状态，还需要等待一个时间计时器设置的时间 2MSL。这么做有两个理由：

     - 确保最后一个确认报文能够到达。如果 B 没收到 A 发送来的确认报文，那么就会重新发送连接释放请求报文，A 等待一段时间就是为了处理这种情况的发生。
     - 等待一段时间是为了让本连接持续时间内所产生的所有报文都从网络中消失，使得下一个新的连接不会出现旧的连接请求报文。
   - CLOSE_WAIT：服务器端向客户端发送 ACK 报文后进入CLOSE_WAIT状态，CLOSE_WAIT过多的原因一般就是程序问题，可能是服务器端的代码没有写 close 函数关闭 socket 连接，也就不会发出 FIN 报文段；或者出现死循环，服务器端的代码永远执行不到 close。

4. HashMap的实现原理

   推荐一篇博客：[一篇文章彻底读懂HashMap之HashMap源码解析](https://blog.csdn.net/liewen_/article/details/82940272)

   个人认为以下几点比较重要：

   - HashMap的内部存储结构
   - 什么时候会由链表转为红黑树
   - 为什么使用红黑树而不是其他的
   - 懒加载，第一次调用put的时候才会触发map的初始化

   - 为什么HashMap的size一定要设置成2的整数次方倍
   - 线程不安全
   - HashMap中为LinkedHashMap预留了一些hook方法（借用我们老师的一句话，这点可以说的轻描淡写一点，更能起到装x的效果）

5. 快排的基本思路、时间空间复杂度，有什么可以改进的地方？

   - pivot的选取
   - 当递归到长度很小的序列（5~25）的时候可以改用插入排序

6. 概率题

   > 一架飞机上有100个座位，编号1~100，有100个人坐飞机，编号1~100。第一个人因为喝醉了，所以随便坐了一个座位，后面来的人，如果发现自己对应的座位没有坐人就直接坐上去，如果坐了人就随机坐一个，问第100个人坐到自己座位的概率

   等价于：后面来的每一个人，如果发现自己的座位被酒鬼坐了，那么他就让酒鬼离开随便再找一个座位，自己坐到自己的位置上，那么当最后一个人上飞机的时候，酒鬼坐在1号和100号的概率相同，所以第100个人坐到自己座位的概率是1/2。

7. 算法题

   > 给定两个排序数组，求他们中第k大的数

   当时听到这道题目激动的不行，就是leetcode热题100里的一道hard题（面试前把所有热题里的hard全部做了一遍还是有用的），当然表面上还是要装出没做过的样子，从最一般的解法开始分析起，具体的解法可以参考leetcode第四题，[寻找两个有序数组的中位数](https://leetcode-cn.com/problems/median-of-two-sorted-arrays/)



### 三面 3-27

1. 项目介绍（比二面问的要详细很多，问到了一个AOP的底层原理）

2. 算法题

   > 给定一个带权有向无环图，起始点source和终止点target，求最短路径

   听到题目的一瞬间想到了Dijkstra算法，但是具体的算法几乎完全不记得了，面试官说没事可以慢慢分析，也不一定要用这种算法，然后用BFS完成的。

3. 设计题

   > 设计出一个workflow，里面有三种不同的指令
   >
   > - t：task，用户执行的语句
   > - if condition：if语句，如果condition为ture的话继续执行下去，后面的指令为该if的子语句
   > - while condition：while语句，如果condition为ture的话持续执行下去，后面的指令为该while的子语句
   >
   > 一个具体的例子：
   >
   > ```java
   > t1
   > t2
   > if(c1)
   > 	t3
   > 	if(c2)
   > 		t4
   > while(c3)
   > 	t5
   > ```
   >
   > 现在请你设计出一个通用的数据结构，让用户可以很方便的通过调用你的数据结构来完成自己的逻辑。
   >

   一开始以为就是简单的一个组合模式的应用，把大致的框架写完之后面试官提示说，用户的指令是要真实可以执行的，所以不能简单化为一个String或者一个类，后面基本上就是按照面试官的思路把原先简单化成类的改为了用户可以自己实现的接口。一顿折腾下来之后感觉自己的脑细胞也已经用光了，最后看时间差不多了他还留了一个思考题让我可以结束之后想一下：

   > 回去思考：如果我想一次每次只执行一条task，可以实现吗？同时也推荐参考一下JMeter的设计。

   后来想了一些实现的方法，也不知道会不会突然加个四面来问，具体的思路有点复杂这里就不再展开讲了，以后有机会再单独写一篇博客分析一下，也欢迎有想法的人来和我交流。



### 总结

3月30号晚上收到了通过了邮件，整体的面试流程和体验都还是不错的，个人感觉字节的效率也比较高（但由于我大都是周五面试所以要等多一个双休日的时间），总体来说感觉问到的网络、数据库、操作系统、Java等知识不是很多，刷算法的话建议可以先刷leetcode上的热题100和剑指offer，最后祝大家都可以拿到自己满意的offer！



